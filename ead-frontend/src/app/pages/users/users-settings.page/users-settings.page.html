<main class="min-h-screen bg-linear-to-br from-slate-900 via-slate-950 to-black text-slate-100 antialiased space-bg">
  <!-- Topbar -->
  <header class="sticky top-0 z-40 backdrop-blur-xl bg-slate-900/40 ring-1 ring-white/10">
    <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
      <a routerLink="/dashboard" class="inline-flex items-center gap-2 text-sm text-slate-300 hover:text-white cursor-pointer">
        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M15 18l-6-6 6-6"/></svg>
        Back to dashboard
      </a>
      <div class="flex items-center gap-2">
        <div class="h-9 w-9 grid place-items-center rounded-xl bg-linear-to-br from-primary to-primary/40 ring-1 ring-white/20">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 3l7 4v10l-7 4-7-4V7l7-4z" stroke="white" stroke-width="1.4" opacity=".9"/><circle cx="12" cy="12" r="2.2" fill="white" opacity=".9"/></svg>
        </div>
        <span class="font-semibold">EAD</span>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-6 lg:p-10">
    <h1 class="text-2xl font-semibold tracking-tight mb-6">User Settings</h1>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left column: profile info -->
      <section class="lg:col-span-2 rounded-2xl bg-white/5 ring-1 ring-white/10 shadow-glass p-6">
        <h2 class="text-lg font-semibold mb-4">Profile</h2>
        <form class="space-y-5" [formGroup]="userSettingsFormGroup">
          <div class="flex items-center gap-4">
            <img id="avatarPreview" class="h-16 w-16 rounded-full ring-1 ring-white/20 object-cover" src="https://i.pravatar.cc/100?img=5" alt="avatar" />
            <div>
              <label class="block text-sm text-slate-300 mb-1">Profile photo</label>
              <label class="inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-white/10 ring-1 ring-white/10 text-sm cursor-pointer hover:bg-white/15">
                <input id="avatarInput" type="file" accept="image/*" class="hidden" />
                Upload new
              </label>
            </div>
          </div>

          @if (usersSelectors.userSettingState().loading) {
            <div class="grid place-items-center py-10">
              <svg class="h-8 w-8 animate-spin text-white/50" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            </div>
          } @else {
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="text-sm text-slate-300">Full name</label>
                <input formControlName="fullName" type="text" placeholder="Your name" class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
              </div>
              <div>
                <label class="text-sm text-slate-300">Username</label>
                <input formControlName="username" type="text" placeholder="@username"
                class="
                    mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60
                  disabled:bg-slate-700
                    disabled:opacity-60
                    disabled:cursor-not-allowed
                " />
              </div>

              <div>
                <label class="text-sm text-slate-300">Phone number</label>
                <input formControlName="phoneNumber" type="text" placeholder="Your phone number" class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
              </div>

              <div>
                <label class="text-sm text-slate-300">CPF</label>
                <input formControlName="cpf" type="text" placeholder="Your CPF"
                class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
              </div>



              <div class="md:col-span-2">
                <label class="text-sm text-slate-300">Email</label>
                <input formControlName="email" type="email" placeholder="you@mail.com"
                class="
                    mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60
                  disabled:bg-slate-700
                    disabled:opacity-60
                    disabled:cursor-not-allowed
                " />
              </div>
            </div>

            <div class="flex items-center justify-end gap-3 pt-2">
              <button type="button" class="rounded-xl px-4 py-2 bg-white/10 ring-1 ring-white/10 hover:bg-white/15">Cancel</button>
              <button class="rounded-xl px-4 py-2 bg-white/10 ring-1 ring-white/10 hover:bg-white/15" (click)="saveUserSettings()">Save changes</button>
            </div>
          }

        </form>
      </section>

      <!-- Right column: password + preferences -->
      <aside class="space-y-6">
        <section class="rounded-2xl bg-white/5 ring-1 ring-white/10 shadow-glass p-6">
          <h2 class="text-lg font-semibold mb-4">Change password</h2>
          <form class="space-y-4" action="#" method="POST">
            <div>
              <label class="text-sm text-slate-300">Current password</label>
              <input type="password" class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
            </div>
            <div>
              <label class="text-sm text-slate-300">New password</label>
              <input type="password" class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
            </div>
            <div>
              <label class="text-sm text-slate-300">Confirm new password</label>
              <input type="password" class="mt-1 w-full rounded-xl bg-white/5 px-3 py-2 ring-1 ring-white/10 outline-none focus:ring-2 focus:ring-primary/60" />
            </div>
            <button class="w-full rounded-xl bg-linear-to-br from-primary to-primary.dark py-2.5 font-medium ring-1 ring-white/10 hover:brightness-110">Update password</button>
          </form>
        </section>

        <section class="rounded-2xl bg-white/5 ring-1 ring-white/10 shadow-glass p-6">
          <h2 class="text-lg font-semibold mb-4">Preferences</h2>
          <div class="space-y-3 text-sm">
            <label class="flex items-center justify-between gap-4 rounded-xl bg-white/5 ring-1 ring-white/10 p-3">
              <span>Dark mode</span>
              <input type="checkbox" checked class="h-5 w-10 rounded-full appearance-none bg-white/20 ring-1 ring-white/10 checked:bg-primary relative transition cursor-pointer" />
            </label>
            <label class="flex items-center justify-between gap-4 rounded-xl bg-white/5 ring-1 ring-white/10 p-3">
              <span>Email notifications</span>
              <input type="checkbox" class="h-5 w-10 rounded-full appearance-none bg-white/20 ring-1 ring-white/10 checked:bg-primary relative transition cursor-pointer" />
            </label>
          </div>
        </section>

        <section class="rounded-2xl bg-white/5 ring-1 ring-white/10 shadow-glass p-6">
          <h2 class="text-lg font-semibold mb-3 text-red-300">Danger zone</h2>
          <p class="text-sm text-slate-300">Delete your account and all related data.</p>
          <button class="mt-3 w-full rounded-xl bg-red-500/80 hover:bg-red-500 text-white py-2.5 ring-1 ring-white/10">Delete account</button>
        </section>
      </aside>
    </div>
  </main>

  <script>
    // Avatar preview (no upload backend yet)
    const input = document.getElementById('avatarInput');
    const preview = document.getElementById('avatarPreview');
    if (input) {
      input.addEventListener('change', (e) => {
        const file = e.target.files?.[0];
        if (!file) return;
        const url = URL.createObjectURL(file);
        preview.src = url;
      });
    }
  </script>
</main>
